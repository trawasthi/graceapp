{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nvar _jsxFileName = \"/Users/startek/Desktop/Grace/src/booking.js\";\nimport React, { Component } from 'react';\nimport { Container, Content, Form, Item, Label, Input, Button, Picker, Icon, Text } from 'native-base';\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport { withFirebase } from \"./firebase/firebase\";\n\nvar BookingClass = function (_Component) {\n  _inherits(BookingClass, _Component);\n\n  function BookingClass(props) {\n    var _this;\n\n    _classCallCheck(this, BookingClass);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(BookingClass).call(this, props));\n\n    _this.onQueriesChange = function (value) {\n      _this.setState({\n        bookOpt: value\n      });\n    };\n\n    _this.onDateTimeChange = function (value) {\n      _this.setState({\n        bookTime: value\n      });\n    };\n\n    _this.onFormSubmit = function () {\n      if (_this.state.fullName === '') {\n        Alert.alert('Invalid Input', 'Please enter your name', [{\n          text: 'Ok',\n          onPress: function onPress() {\n            return null;\n          }\n        }]);\n        return;\n      }\n\n      if (_this.state.phoneNumber === '') {\n        Alert.alert('Invalid Input', 'Please enter a valid phone number', [{\n          text: 'Ok',\n          onPress: function onPress() {\n            return null;\n          }\n        }]);\n        return;\n      }\n\n      if (_this.state.email === '') {\n        Alert.alert('Invalid Input', 'Please enter a valid email', [{\n          text: 'Ok',\n          onPress: function onPress() {\n            return null;\n          }\n        }]);\n        return;\n      }\n\n      if (_this.state.address === '') {\n        Alert.alert('Invalid Input', 'Please enter address', [{\n          text: 'Ok',\n          onPress: function onPress() {\n            return null;\n          }\n        }]);\n        return;\n      }\n\n      if (_this.state.bookOpt === '') {\n        Alert.alert('Invalid Input', 'Please enter your booking query category', [{\n          text: 'Ok',\n          onPress: function onPress() {\n            return null;\n          }\n        }]);\n        return;\n      }\n\n      if (_this.state.bookTime === '') {\n        Alert.alert('Invalid Input', 'Please enter appointment date and time', [{\n          text: 'Ok',\n          onPress: function onPress() {\n            return null;\n          }\n        }]);\n      }\n\n      _this.props.firebase.db.ref(\"Booked_Appointments/\" + _this.state.phoneNumber).set({\n        Name: _this.state.fullName,\n        Phone: _this.state.phoneNumber,\n        Email: _this.state.email,\n        Address: _this.state.address,\n        BookingQuery: _this.state.bookOpt,\n        BookingTime: _this.state.bookTime\n      }, function (error) {\n        if (error) {\n          Alert.alert('Faild', 'Failed to book appointment. Please try again later.', [{\n            text: 'Ok',\n            onPress: function onPress() {\n              _this.props.navigation.navigate('Home');\n            }\n          }]);\n        } else {\n          _this.props.firebase.db.ref('/Available_Appointments').once('value').then(function (snapshot) {\n            var data = snapshot.val();\n\n            for (var val in data) {\n              if (data[val] === _this.state.bookTime) {\n                _this.props.firebase.db.ref(\"Available_Appointments/\" + val).remove();\n\n                break;\n              }\n            }\n          });\n\n          fetch(\"https://us-central1-grace-5010b.cloudfunctions.net/sendConfirmationEmail?email=\" + _this.state.email + \"&name=\" + _this.state.fullName + \"&time=\" + _this.state.bookTime).then(function (response) {\n            return response.json();\n          }).then(function (responseJson) {\n            console.log(responseJson);\n          }).catch(function (error) {\n            console.error(error);\n          });\n          Alert.alert('Done', 'You have booked an appointment.', [{\n            text: 'Ok',\n            onPress: function onPress() {\n              _this.props.navigation.navigate('Home');\n            }\n          }]);\n        }\n      });\n    };\n\n    _this.state = {\n      fullName: '',\n      phoneNumber: '',\n      email: '',\n      address: '',\n      bookOpt: '',\n      bookTime: '',\n      availableTime: []\n    };\n    return _this;\n  }\n\n  _createClass(BookingClass, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.props.firebase.db.ref('/Available_Appointments').once('value').then(function (snapshot) {\n        var data = snapshot.val();\n        var dataArray = Object.values(data);\n\n        _this2.setState({\n          availableTime: dataArray\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      return React.createElement(Container, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        }\n      }, React.createElement(Content, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        }\n      }, React.createElement(Form, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        }\n      }, React.createElement(Item, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204\n        }\n      }, React.createElement(Label, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        }\n      }, \"Full Name\"), React.createElement(Input, {\n        onChangeText: function onChangeText(fullName) {\n          return _this3.setState({\n            fullName: fullName\n          });\n        },\n        value: this.state.fullName,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206\n        }\n      })), React.createElement(Item, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211\n        }\n      }, React.createElement(Label, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212\n        }\n      }, \"Phone number\"), React.createElement(Input, {\n        keyboardType: \"numeric\",\n        onChangeText: function onChangeText(phoneNumber) {\n          return _this3.setState({\n            phoneNumber: phoneNumber\n          });\n        },\n        value: this.state.phoneNumber,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213\n        }\n      })), React.createElement(Item, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219\n        }\n      }, React.createElement(Label, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220\n        }\n      }, \"Email\"), React.createElement(Input, {\n        autoCapitalize: \"none\",\n        onChangeText: function onChangeText(email) {\n          return _this3.setState({\n            email: email\n          });\n        },\n        value: this.state.email,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221\n        }\n      })), React.createElement(Item, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227\n        }\n      }, React.createElement(Label, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228\n        }\n      }, \"Address\"), React.createElement(Input, {\n        onChangeText: function onChangeText(address) {\n          return _this3.setState({\n            address: address\n          });\n        },\n        value: this.state.address,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 229\n        }\n      })), React.createElement(Item, {\n        style: {\n          marginTop: 16,\n          borderColor: 'transparent'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234\n        }\n      }, React.createElement(Label, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235\n        }\n      }, \"What do you want to book for?\")), React.createElement(Item, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 237\n        }\n      }, React.createElement(Picker, {\n        mode: \"dropdown\",\n        iosHeader: \"Queries\",\n        iosIcon: React.createElement(Icon, {\n          name: \"arrow-down\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 241\n          }\n        }),\n        selectedValue: this.state.bookOpt,\n        onValueChange: this.onQueriesChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238\n        }\n      }, React.createElement(Picker.Item, {\n        label: \"Migration\",\n        value: \"Migration\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 244\n        }\n      }), React.createElement(Picker.Item, {\n        label: \"Study\",\n        value: \"Study\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 245\n        }\n      }), React.createElement(Picker.Item, {\n        label: \"PTE/IELTS\",\n        value: \"PTE/IELTS\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246\n        }\n      }), React.createElement(Picker.Item, {\n        label: \"Professional year\",\n        value: \"Professional year\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 247\n        }\n      }))), React.createElement(Item, {\n        style: {\n          marginTop: 16,\n          borderColor: 'transparent'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250\n        }\n      }, React.createElement(Label, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251\n        }\n      }, \"Select apointment date and time\")), React.createElement(Item, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 253\n        }\n      }, React.createElement(Picker, {\n        mode: \"dropdown\",\n        iosHeader: \"Date/Time\",\n        iosIcon: React.createElement(Icon, {\n          name: \"arrow-down\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 257\n          }\n        }),\n        selectedValue: this.state.bookTime,\n        onValueChange: this.onDateTimeChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 254\n        }\n      }, this.state.availableTime.map(function (value, i) {\n        return React.createElement(Picker.Item, {\n          key: i,\n          label: value,\n          value: value,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 261\n          }\n        });\n      })))), React.createElement(Button, {\n        style: {\n          textAlign: 'center',\n          justifyContent: 'center',\n          alignItems: 'center',\n          marginTop: 16,\n          backgroundColor: '#2196f3'\n        },\n        primary: true,\n        rounded: true,\n        onPress: this.onFormSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 266\n        }\n      }, React.createElement(Text, {\n        style: {\n          fontWeight: 'bold'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 277\n        }\n      }, \" Book Now \"))));\n    }\n  }]);\n\n  return BookingClass;\n}(Component);\n\nvar Booking = withFirebase(BookingClass);\nBooking.navigationOptions = {\n  title: 'Booking'\n};\nexport default Booking;","map":{"version":3,"sources":["/Users/startek/Desktop/Grace/src/booking.js"],"names":["React","Component","Container","Content","Form","Item","Label","Input","Button","Picker","Icon","Text","withFirebase","BookingClass","props","onQueriesChange","value","setState","bookOpt","onDateTimeChange","bookTime","onFormSubmit","state","fullName","Alert","alert","text","onPress","phoneNumber","email","address","firebase","db","ref","set","Name","Phone","Email","Address","BookingQuery","BookingTime","error","navigation","navigate","once","then","snapshot","data","val","remove","fetch","response","json","responseJson","console","log","catch","availableTime","dataArray","Object","values","marginTop","borderColor","map","i","textAlign","justifyContent","alignItems","backgroundColor","fontWeight","Booking","navigationOptions","title"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport {\n  Container,\n  Content,\n  Form,\n  Item,\n  Label,\n  Input,\n  Button,\n  Picker,\n  Icon,\n  Text\n} from 'native-base';\nimport { Alert } from 'react-native';\nimport { withFirebase } from './firebase/firebase';\n\n// Main class for booking\nclass BookingClass extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      fullName: '',\n      phoneNumber: '',\n      email: '',\n      address: '',\n      bookOpt: '',\n      bookTime: '',\n      availableTime: []\n    };\n  }\n\n  componentDidMount() {\n    // load all the available appointment during mount\n    this.props.firebase.db\n      .ref('/Available_Appointments')\n      .once('value')\n      .then(snapshot => {\n        const data = snapshot.val();\n        const dataArray = Object.values(data);\n        this.setState({ availableTime: dataArray });\n      });\n  }\n\n  // set booking queries\n  onQueriesChange = value => {\n    this.setState({\n      bookOpt: value\n    });\n  };\n\n  // set booking date/time\n  onDateTimeChange = value => {\n    this.setState({\n      bookTime: value\n    });\n  };\n\n  // handle booking function\n  onFormSubmit = () => {\n    // check if fullname is entered\n    if (this.state.fullName === '') {\n      Alert.alert('Invalid Input', 'Please enter your name', [\n        {\n          text: 'Ok',\n          onPress: () => {\n            return null;\n          }\n        }\n      ]);\n      return;\n    }\n    // check if phone number is entered\n    if (this.state.phoneNumber === '') {\n      Alert.alert('Invalid Input', 'Please enter a valid phone number', [\n        {\n          text: 'Ok',\n          onPress: () => {\n            return null;\n          }\n        }\n      ]);\n      return;\n    }\n\n    // check if email is entered\n    if (this.state.email === '') {\n      Alert.alert('Invalid Input', 'Please enter a valid email', [\n        {\n          text: 'Ok',\n          onPress: () => {\n            return null;\n          }\n        }\n      ]);\n      return;\n    }\n\n    // check if address is entered\n    if (this.state.address === '') {\n      Alert.alert('Invalid Input', 'Please enter address', [\n        {\n          text: 'Ok',\n          onPress: () => {\n            return null;\n          }\n        }\n      ]);\n      return;\n    }\n\n    // check if booking query is entered\n    if (this.state.bookOpt === '') {\n      Alert.alert('Invalid Input', 'Please enter your booking query category', [\n        {\n          text: 'Ok',\n          onPress: () => {\n            return null;\n          }\n        }\n      ]);\n      return;\n    }\n\n    // check if booking time is entered\n    if (this.state.bookTime === '') {\n      Alert.alert('Invalid Input', 'Please enter appointment date and time', [\n        {\n          text: 'Ok',\n          onPress: () => {\n            return null;\n          }\n        }\n      ]);\n    }\n\n    // db operation\n    // add user booking info to database\n    this.props.firebase.db.ref(`Booked_Appointments/${this.state.phoneNumber}`).set(\n      {\n        Name: this.state.fullName,\n        Phone: this.state.phoneNumber,\n        Email: this.state.email,\n        Address: this.state.address,\n        BookingQuery: this.state.bookOpt,\n        BookingTime: this.state.bookTime\n      },\n      error => {\n        // error handling\n        if (error) {\n          Alert.alert('Faild', 'Failed to book appointment. Please try again later.', [\n            {\n              text: 'Ok',\n              onPress: () => {\n                this.props.navigation.navigate('Home');\n              }\n            }\n          ]);\n        } else {\n          // remove selected appointment\n          this.props.firebase.db\n            .ref('/Available_Appointments')\n            .once('value')\n            .then(snapshot => {\n              const data = snapshot.val();\n              for (const val in data) {\n                if (data[val] === this.state.bookTime) {\n                  this.props.firebase.db.ref(`Available_Appointments/${val}`).remove();\n                  break;\n                }\n              }\n            });\n\n          // send confirmation email\n          fetch(\n            `https://us-central1-grace-5010b.cloudfunctions.net/sendConfirmationEmail?email=${this.state.email}&name=${this.state.fullName}&time=${this.state.bookTime}`\n          )\n            .then(response => response.json())\n            .then(responseJson => {\n              console.log(responseJson);\n            })\n            .catch(error => {\n              console.error(error);\n            });\n\n          // display success message\n          Alert.alert('Done', 'You have booked an appointment.', [\n            {\n              text: 'Ok',\n              onPress: () => {\n                this.props.navigation.navigate('Home');\n              }\n            }\n          ]);\n        }\n      }\n    );\n  };\n\n  render() {\n    return (\n      <Container>\n        <Content>\n          <Form>\n            <Item>\n              <Label>Full Name</Label>\n              <Input\n                onChangeText={fullName => this.setState({ fullName })}\n                value={this.state.fullName}\n              />\n            </Item>\n            <Item>\n              <Label>Phone number</Label>\n              <Input\n                keyboardType=\"numeric\"\n                onChangeText={phoneNumber => this.setState({ phoneNumber })}\n                value={this.state.phoneNumber}\n              />\n            </Item>\n            <Item>\n              <Label>Email</Label>\n              <Input\n                autoCapitalize=\"none\"\n                onChangeText={email => this.setState({ email })}\n                value={this.state.email}\n              />\n            </Item>\n            <Item>\n              <Label>Address</Label>\n              <Input\n                onChangeText={address => this.setState({ address })}\n                value={this.state.address}\n              />\n            </Item>\n            <Item style={{ marginTop: 16, borderColor: 'transparent' }}>\n              <Label>What do you want to book for?</Label>\n            </Item>\n            <Item>\n              <Picker\n                mode=\"dropdown\"\n                iosHeader=\"Queries\"\n                iosIcon={<Icon name=\"arrow-down\" />}\n                selectedValue={this.state.bookOpt}\n                onValueChange={this.onQueriesChange}>\n                <Picker.Item label=\"Migration\" value=\"Migration\" />\n                <Picker.Item label=\"Study\" value=\"Study\" />\n                <Picker.Item label=\"PTE/IELTS\" value=\"PTE/IELTS\" />\n                <Picker.Item label=\"Professional year\" value=\"Professional year\" />\n              </Picker>\n            </Item>\n            <Item style={{ marginTop: 16, borderColor: 'transparent' }}>\n              <Label>Select apointment date and time</Label>\n            </Item>\n            <Item>\n              <Picker\n                mode=\"dropdown\"\n                iosHeader=\"Date/Time\"\n                iosIcon={<Icon name=\"arrow-down\" />}\n                selectedValue={this.state.bookTime}\n                onValueChange={this.onDateTimeChange}>\n                {this.state.availableTime.map((value, i) => (\n                  <Picker.Item key={i} label={value} value={value} />\n                ))}\n              </Picker>\n            </Item>\n          </Form>\n          <Button\n            style={{\n              textAlign: 'center',\n              justifyContent: 'center',\n              alignItems: 'center',\n              marginTop: 16,\n              backgroundColor: '#2196f3'\n            }}\n            primary\n            rounded\n            onPress={this.onFormSubmit}>\n            <Text style={{ fontWeight: 'bold' }}> Book Now </Text>\n          </Button>\n        </Content>\n      </Container>\n    );\n  }\n}\n\n// connect booking class to firebase functions\nconst Booking = withFirebase(BookingClass);\nBooking.navigationOptions = {\n  title: 'Booking'\n};\n\nexport default Booking;\n"]},"metadata":{},"sourceType":"module"}